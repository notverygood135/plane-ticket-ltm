<!DOCTYPE html>
<html>
    <body>
        <div id="ticket-info"></div>
        <div>
            <button type="button" onclick="cancel()">Cancel</button>
            <button type="button" onclick="exchange()">Exchange</button>
            <button type="button" onclick="print_ticket()">Print</button>
        </div>
    </body>
    <script>
        const url = window.location.pathname;
        const id = url.split("/")[2];

        function renderTicket(ticket) {
            const ticketInfo = document.getElementById("ticket-info");
            for (let key in ticket) {
                const div = document.createElement("div");
                div.className = "ticket-info-column";
                div.innerHTML = ticket[key];
                ticketInfo.appendChild(div);
            }
        }

        fetch(`/ticket/${id}`, {
            method: "GET",
        })
        .then(response => {
            return(response.text());
        })
        .then(data => {
            const ticket = JSON.parse(data)[0];
            renderTicket(ticket);
        })

        function cancel() {
            fetch(`/own/${id}`, {
                method: "DELETE",
                headers: {
                    "Content-Type": "text/html"
                },
                body: `ticket_id=${id}`
            })
            .then(response => {
                return(response.status);
            })
            .then(status => {
                if (status == 200) {
                    window.location.replace("http://localhost:8001/inventory");
                }
                else {
                    alert("Error");
                }
            });
        }

        function exchange() {

        }

        function print_ticket() {
            window.print();
        }
    </script>
</html>